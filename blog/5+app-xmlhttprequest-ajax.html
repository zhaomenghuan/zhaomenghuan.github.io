<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>mui 初级入门教程（三）— html5+ XMLHttpRequest 与 mui ajax 用法详解 | 匠心博客</title>
    <meta name="description" content="小青年,匠心,小青年博客,匠心博客,前端开发,android,技术宅,菜鸟教程,一个神奇的博客。">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.685c010a.css" as="style"><link rel="preload" href="/assets/js/app.f3e141ba.js" as="script"><link rel="preload" href="/assets/js/45.2206665b.js" as="script"><link rel="preload" href="/assets/js/18.c373a36e.js" as="script"><link rel="preload" href="/assets/js/34.124c31c0.js" as="script"><link rel="prefetch" href="/assets/js/1.1950ec81.js"><link rel="prefetch" href="/assets/js/10.7f857e71.js"><link rel="prefetch" href="/assets/js/100.e03c01d2.js"><link rel="prefetch" href="/assets/js/101.7b790a2f.js"><link rel="prefetch" href="/assets/js/102.a7aa77f9.js"><link rel="prefetch" href="/assets/js/103.d473991c.js"><link rel="prefetch" href="/assets/js/104.9fe8785c.js"><link rel="prefetch" href="/assets/js/105.7291ae49.js"><link rel="prefetch" href="/assets/js/106.2c35a2f4.js"><link rel="prefetch" href="/assets/js/107.a71ccb64.js"><link rel="prefetch" href="/assets/js/108.9d6f54a8.js"><link rel="prefetch" href="/assets/js/109.e77d12ca.js"><link rel="prefetch" href="/assets/js/11.5378ae65.js"><link rel="prefetch" href="/assets/js/12.9aca40f8.js"><link rel="prefetch" href="/assets/js/13.ce2b655c.js"><link rel="prefetch" href="/assets/js/14.7488ca24.js"><link rel="prefetch" href="/assets/js/15.9c07ac98.js"><link rel="prefetch" href="/assets/js/16.8f57294c.js"><link rel="prefetch" href="/assets/js/17.4f7ae4ec.js"><link rel="prefetch" href="/assets/js/19.c7be2474.js"><link rel="prefetch" href="/assets/js/2.7f7e5268.js"><link rel="prefetch" href="/assets/js/20.f8833113.js"><link rel="prefetch" href="/assets/js/21.e71dd521.js"><link rel="prefetch" href="/assets/js/22.92dc7b77.js"><link rel="prefetch" href="/assets/js/23.285557d3.js"><link rel="prefetch" href="/assets/js/24.a803551c.js"><link rel="prefetch" href="/assets/js/25.dbeaa19d.js"><link rel="prefetch" href="/assets/js/26.9ca97076.js"><link rel="prefetch" href="/assets/js/27.d1a2911b.js"><link rel="prefetch" href="/assets/js/28.25c216b3.js"><link rel="prefetch" href="/assets/js/29.9dc30af4.js"><link rel="prefetch" href="/assets/js/30.1e9d6e06.js"><link rel="prefetch" href="/assets/js/31.3d7dbe62.js"><link rel="prefetch" href="/assets/js/32.36371ba7.js"><link rel="prefetch" href="/assets/js/33.78edc66d.js"><link rel="prefetch" href="/assets/js/35.a5470008.js"><link rel="prefetch" href="/assets/js/36.acde7543.js"><link rel="prefetch" href="/assets/js/37.f6648812.js"><link rel="prefetch" href="/assets/js/38.1885784f.js"><link rel="prefetch" href="/assets/js/39.af4b4bbd.js"><link rel="prefetch" href="/assets/js/4.61024115.js"><link rel="prefetch" href="/assets/js/40.ec6e88a9.js"><link rel="prefetch" href="/assets/js/41.67d4e8b7.js"><link rel="prefetch" href="/assets/js/42.7de428af.js"><link rel="prefetch" href="/assets/js/43.b4f51fa8.js"><link rel="prefetch" href="/assets/js/44.487d119d.js"><link rel="prefetch" href="/assets/js/46.125163cc.js"><link rel="prefetch" href="/assets/js/47.8722f507.js"><link rel="prefetch" href="/assets/js/48.b8bfe77f.js"><link rel="prefetch" href="/assets/js/49.77fac897.js"><link rel="prefetch" href="/assets/js/5.3395f0b5.js"><link rel="prefetch" href="/assets/js/50.d68289a2.js"><link rel="prefetch" href="/assets/js/51.d9d70556.js"><link rel="prefetch" href="/assets/js/52.6a2c9e02.js"><link rel="prefetch" href="/assets/js/53.ff13cf8b.js"><link rel="prefetch" href="/assets/js/54.7e844902.js"><link rel="prefetch" href="/assets/js/55.80aa3d86.js"><link rel="prefetch" href="/assets/js/56.a4124774.js"><link rel="prefetch" href="/assets/js/57.55eb7355.js"><link rel="prefetch" href="/assets/js/58.7d0e2bc5.js"><link rel="prefetch" href="/assets/js/59.9cdd695c.js"><link rel="prefetch" href="/assets/js/6.77e8533c.js"><link rel="prefetch" href="/assets/js/60.54318be9.js"><link rel="prefetch" href="/assets/js/61.82e1ea82.js"><link rel="prefetch" href="/assets/js/62.b065e499.js"><link rel="prefetch" href="/assets/js/63.bb770dde.js"><link rel="prefetch" href="/assets/js/64.996fdbfd.js"><link rel="prefetch" href="/assets/js/65.54f3baf3.js"><link rel="prefetch" href="/assets/js/66.38d28ab3.js"><link rel="prefetch" href="/assets/js/67.5cf5a3bc.js"><link rel="prefetch" href="/assets/js/68.f2418476.js"><link rel="prefetch" href="/assets/js/69.162d06c4.js"><link rel="prefetch" href="/assets/js/7.a2cd9d6c.js"><link rel="prefetch" href="/assets/js/70.80f1252b.js"><link rel="prefetch" href="/assets/js/71.970dda3c.js"><link rel="prefetch" href="/assets/js/72.a073c997.js"><link rel="prefetch" href="/assets/js/73.674106d1.js"><link rel="prefetch" href="/assets/js/74.a0336873.js"><link rel="prefetch" href="/assets/js/75.37fbb329.js"><link rel="prefetch" href="/assets/js/76.a9439343.js"><link rel="prefetch" href="/assets/js/77.d52439f1.js"><link rel="prefetch" href="/assets/js/78.fbffcd6c.js"><link rel="prefetch" href="/assets/js/79.c6d73001.js"><link rel="prefetch" href="/assets/js/8.f0af9f9c.js"><link rel="prefetch" href="/assets/js/80.eab87966.js"><link rel="prefetch" href="/assets/js/81.9931436f.js"><link rel="prefetch" href="/assets/js/82.b29080c9.js"><link rel="prefetch" href="/assets/js/83.d94ed517.js"><link rel="prefetch" href="/assets/js/84.600be30f.js"><link rel="prefetch" href="/assets/js/85.a6938cc3.js"><link rel="prefetch" href="/assets/js/86.7dec6ed4.js"><link rel="prefetch" href="/assets/js/87.5d2c1dc9.js"><link rel="prefetch" href="/assets/js/88.8f2410d4.js"><link rel="prefetch" href="/assets/js/89.fe8c04e8.js"><link rel="prefetch" href="/assets/js/9.f542ab97.js"><link rel="prefetch" href="/assets/js/90.f25166a8.js"><link rel="prefetch" href="/assets/js/91.038ee701.js"><link rel="prefetch" href="/assets/js/92.19e610e0.js"><link rel="prefetch" href="/assets/js/93.22cd83c8.js"><link rel="prefetch" href="/assets/js/94.7495cfa6.js"><link rel="prefetch" href="/assets/js/95.f149c41d.js"><link rel="prefetch" href="/assets/js/96.cee91e1f.js"><link rel="prefetch" href="/assets/js/97.27a1bb57.js"><link rel="prefetch" href="/assets/js/98.67d4f125.js"><link rel="prefetch" href="/assets/js/99.35daa60c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.685c010a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">匠心博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/index.html" class="nav-link">博文</a></div><div class="nav-item"><a href="/book/index.html" class="nav-link">专栏</a></div><div class="nav-item"><a href="/note/index.html" class="nav-link">笔记</a></div><div class="nav-item"><a href="/nav/index.html" class="nav-link">导航</a></div><div class="nav-item"><a href="/about/index.html" class="nav-link">关于</a></div> <a href="https://github.com/zhaomenghuan" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/index.html" class="nav-link">博文</a></div><div class="nav-item"><a href="/book/index.html" class="nav-link">专栏</a></div><div class="nav-item"><a href="/note/index.html" class="nav-link">笔记</a></div><div class="nav-item"><a href="/nav/index.html" class="nav-link">导航</a></div><div class="nav-item"><a href="/about/index.html" class="nav-link">关于</a></div> <a href="https://github.com/zhaomenghuan" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>mui 初级入门教程（三）— html5+ XMLHttpRequest 与 mui ajax 用法详解</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#写在前面" class="sidebar-link">写在前面</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#基础铺垫" class="sidebar-link">基础铺垫</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#javascript-xmlhttprequest-网络请求" class="sidebar-link">Javascript XMLHttpRequest 网络请求</a></li></ul></li><li><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#跨域请求的几种常用方法" class="sidebar-link">跨域请求的几种常用方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#cors，使用-xmlhttprequest-对象" class="sidebar-link">CORS，使用 XMLHttpRequest 对象</a></li><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#jsonp，只适用于-get-请求" class="sidebar-link">Jsonp，只适用于 get 请求</a></li><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#html5-xmlhttprequest-网络请求" class="sidebar-link">html5+ XMLHttpRequest 网络请求</a></li><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#mui-ajax" class="sidebar-link">mui ajax</a></li></ul></li><li><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#项目实战" class="sidebar-link">项目实战</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#api-分析" class="sidebar-link">API 分析</a></li><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#mui-ajax-请求实例" class="sidebar-link">mui.ajax 请求实例</a></li><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#javascript-json-语法基础" class="sidebar-link">Javascript JSON 语法基础</a></li><li class="sidebar-sub-header"><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#获取数据更新-ui" class="sidebar-link">获取数据更新 UI</a></li></ul></li><li><a href="/blog/5%2Bapp-xmlhttprequest-ajax.html#随便聊聊" class="sidebar-link">随便聊聊</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="mui-初级入门教程（三）—-html5-xmlhttprequest-与-mui-ajax-用法详解">mui 初级入门教程（三）— html5+ XMLHttpRequest 与 mui ajax 用法详解</h1> <h2 id="写在前面">写在前面</h2> <p>这是这个系列的的第三篇文章，前面的文章在多个地方（本人<code>github</code>博客、<code>dcloud ask</code>社区、<code>segmentfault</code>）发出来了，很多朋友收藏点赞，只是没有多少人反映内容的深浅，也没有人提出意见，所以实话说不知道符不符合大家胃口，不过我写博客一向以详细为标准，尽可能照顾到各种人群，特别是入门级的同学，力求还原我学习这个东西的一个思路和过程，在文章中也分享一些不错的干货，最近在折腾博客，用<code>webpack</code>和<code>vue-cli</code>打包了一下，目前还有些问题有待解决，自己尝试写一个 markdown 编辑器因为 bug 过多的问题，然后开始使用马克飞象写博客，毕竟生成的界面美观多了，这样可以方便大家阅读吧。废话不多说，开始我们今天的内容，今天主要是学习一下<code>html5+</code>的<code>XMLHttpRequest</code>以及<code>mui</code>的基本用法。</p> <h2 id="基础铺垫">基础铺垫</h2> <h3 id="javascript-xmlhttprequest-网络请求">Javascript XMLHttpRequest 网络请求</h3> <blockquote><p>XMLHttpRequest 是一个 JavaScript 对象，它最初由微软设计,随后被 Mozilla、Apple 和 Google 采纳. 如今,该对象已经被 W3C 组织标准化. 通过它,你可以很容易的取回一个 URL 上的资源数据. 尽管名字里有 XML, 但 XMLHttpRequest 可以取回所有类型的数据资源，并不局限于 XML。 而且除了 HTTP ,它还支持 file 和 ftp 协议. —— <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener noreferrer">MDN XMLHttpRequest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p><code>XMLHttpRequest</code> 让发送一个<code>HTTP</code>请求变得非常容易。你只需要简单的创建一个请求对象实例，打开一个<code>URL</code>，然后发送这个请求。当传输完毕后，结果的<code>HTTP</code>状态以及返回的响应内容也可以从请求对象中获取。</p> <h4 id="xmlhttprequest-网络请求的一般步骤：">XMLHttpRequest 网络请求的一般步骤：</h4> <p>第一步：创建一个 XMLHttpRequest 实例</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>第二步：初始化 HTTP 请求参数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">void</span> <span class="token function">open</span><span class="token punctuation">(</span>
   DOMString method<span class="token punctuation">,</span>
   DOMString url<span class="token punctuation">,</span>
   optional boolean async<span class="token punctuation">,</span>
   optional DOMString user<span class="token punctuation">,</span>
   optional DOMString password
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>method</strong>：请求所使用的<code>HTTP</code>方法; 例如 <code>&quot;GET&quot;</code>, <code>&quot;POST&quot;</code>, <code>&quot;PUT&quot;</code>, <code>&quot;DELETE&quot;</code>等. 如果下个参数是非<code>HTTP(S)</code>的<code>URL</code>,则忽略该参数.</li> <li><strong>url</strong>：该请求所要访问的<code>URL</code></li> <li><strong>async</strong>：一个可选的布尔值参数，默认为<code>true</code>,意味着是否执行异步操作，如果值为<code>false</code>,则<code>send()</code>方法不会返回任何东西，直到接受到了服务器的返回数据。如果为值为<code>true</code>，一个对开发者透明的通知会发送到相关的事件监听者。这个值必须是<code>true</code>,如果<code>multipart</code>属性是<code>true</code>，否则将会出现一个意外。</li> <li><strong>user</strong>：用户名,可选参数,为授权使用;默认参数为空<code>string</code>.</li> <li><strong>password</strong>：密码,可选参数,为授权使用;默认参数为空<code>string</code>.</li></ul> <p>第三步：发送请求</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>发送请求. 如果该请求是异步模式(默认),该方法会立刻返回. 相反,如果请求是同步模式,则直到请求的响应完全接受以后,该方法才会返回.</p> <p>如下例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://www.baidu.com&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们在 hbuilder 里面打开，控制台会报错：</p> <div class="language- extra-class"><pre class="language-text"><code>[Web浏览器] &quot;XMLHttpRequest cannot load https://www.baidu.com/. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://127.0.0.1:8020' is therefore not allowed access.&quot;
</code></pre></div><p>用浏览器打开，按<code>F12</code>在控制台<code>console</code>下查看也会发现上述错误，这是为啥呢？</p> <p>这是因为普通网页能够使用<code>XMLHttpRequest</code>对象发送或者接受服务器数据, 但是它们受限于<a href="https://en.wikipedia.org/wiki/Same-origin_policy" target="_blank" rel="noopener noreferrer">同源策略<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。只要先获取了跨域请求许可，就可以进行跨域请求。</p> <blockquote><p><strong>同源策略</strong>：如果两个页面的<strong>协议</strong>、<strong>域名</strong>和<strong>端口</strong>是完全相同的，那么它们就是同源的。同源策略是为了防止从一个地址加载的文档或脚本访问或者设置从另外一个地址加载的文档的属性。如果两个页面的主域名相同，则还可以通过设置 <code>document.domain</code>属性将它们认为是同源的。</p></blockquote> <p><img src="https://segmentfault.com/img/bVxCld" alt="clipboard.png"></p> <h2 id="跨域请求的几种常用方法">跨域请求的几种常用方法</h2> <h3 id="cors，使用-xmlhttprequest-对象">CORS，使用 XMLHttpRequest 对象</h3> <p>CORS 的全称是 Cross-Origin Resource Sharing，即跨域资源共享。他的原理就是使用自定义的 HTTP 头部，让服务器与浏览器进行沟通，主要是通过设置响应头的 Access-Control-Allow-Origin 来达到目的的。这样，XMLHttpRequest 就能跨域了。想要进一步了解 CORS 的朋友可以看看这篇文章：<a href="http://www.adobe.com/cn/devnet/html5/articles/understanding-cross-origin-resource-sharing-cors.html" target="_blank" rel="noopener noreferrer">了解跨域资源共享 (CORS)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>在服务器端添加响应头<code>Access-Control-Allow-Origin</code>，使用<code>XMLHttpRequest</code>对象请求。值得注意的是，正常情况下的 XMLHttpRequest 是只发送一次请求的，但是跨域问题下很可能是会发送两次的请求（预发送）。</p> <p>PHP:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Access-Control-Allow-Origin: *'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>java:</p> <div class="language-java extra-class"><pre class="language-java"><code>response<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span> <span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>大家不妨将上面那个例子中的地址换成这个试试：http://zhaomenghuan.github.io/api/blog.json
（仅用于学习测试，禁止直接用于任何不经征求本人同意的站点）</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
			<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://zhaomenghuan.github.io/api/blog.json&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
			    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
			    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
			    	document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pageId <span class="token operator">+</span> <span class="token string">'：'</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token operator">+</span><span class="token string">&quot;&lt;br /&gt;&quot;</span><span class="token punctuation">)</span>
			    <span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>
			xhr<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'error making the request.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		    <span class="token punctuation">}</span><span class="token punctuation">;</span>
			xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>哈哈，执行完这段代码你会发现，你能够查看到我博客的列表，所以大家是不是懂了些什么， CORS 能否跨域实现需要服务器端支持，我们这里能够收到信息，是因为 github 上的资源是支持 CORS 访问的，这和框架无关，很多人以为用了框架就可以跨域，这都是不正确的理解，框架只是封装了一些方法，让我们使用更加方便，能不能跨域还是取决于我们服务器端的访问权限。这里顺便说一下很多人用 mui 会发现在浏览器端会报错，在 app 环境能够访问，这是因为 mui 依赖 html5+ XMLHttpRequest 网络请求模块，后面会详细讲到。</p> <h3 id="jsonp，只适用于-get-请求">Jsonp，<strong>只适用于 get 请求</strong></h3> <p><code>Jsonp</code>的跨域不是用<code>XMLHttpRequest</code>实现的，而是一个<code>script</code>标签，<code>script</code>是可以跨域的，回调函数作为<code>get</code>参数传入请求里。</p> <p>原理很简单，比如你在 A 域名请求 B 域名：</p> <ul><li>在 A 域名的页面中使用 script 标签 src 写成 B 域名中服务器的 URL
script 标签是可以跨域的，比如你调用 Google Map 或 Google Analytics 时引入的 js 就是 google 域名下的。</li> <li>后端程序在最后需要把一段 js 代码的字符串打印出来，这样就可以运行 A 域名 js 中写好的 callback 方法，将要返回的数据放入参数就可以了</li></ul> <p>A 域名中的 js 文件：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">CreateScript</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  el<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  el<span class="token punctuation">.</span>async <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  el<span class="token punctuation">.</span>defer <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 响应的方法</span>
<span class="token keyword">function</span> <span class="token function">jsonpcallback</span><span class="token punctuation">(</span><span class="token parameter">rs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;output&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 发起get请求</span>
<span class="token function">CreateScript</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:8888?userid=001&amp;callback=jsonpcallback&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>B 域名中 node 服务器：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;zhaomenghuan&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token string">&quot;22&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

http
  <span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将url字符串转换成Url对象</span>
    <span class="token keyword">var</span> params <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 查询参数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 根据附件条件查询</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>query<span class="token punctuation">.</span>userid <span class="token operator">===</span> <span class="token string">&quot;001&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 判断是否为jsonp方式请求，若是则使用jsonp方式，否则为普通web方式</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>query<span class="token punctuation">.</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> resurlt <span class="token operator">=</span>
            params<span class="token punctuation">.</span>query<span class="token punctuation">.</span>callback <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>
          res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>resurlt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样我们就可以在 A 域名下跨域请求，当然我们经常看到很多框架如 jquery 对 jsonp 进行了进一步封装，但是基本原理同上面。这里给出两个例子：</p> <ul><li><a href="http://zhaomenghuan.github.io/demo/translation/native-JavaScript.html" target="_blank" rel="noopener noreferrer">native-JavaScript 实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://zhaomenghuan.github.io/demo/translation/mui-jsonp.html" target="_blank" rel="noopener noreferrer">mui-jsonp 实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>总之，不论是<code>XMLHttpRequest</code>的跨域，还是<code>Jsonp</code>，都是需要请求的网站服务器端提供支持，在愿意分享给你数据的情况下你才能得到。在对方没有提供支持的情况下，你是取不到它的数据的。当然跨域的解决方案有很多种，由于本人没有实践过，没有实践就没有发言权，这里给大家贴一个帖子，自己跨域自行验证，<a href="https://segmentfault.com/a/1190000004518374#articleHeader3" target="_blank" rel="noopener noreferrer">浅谈浏览器端 JavaScript 跨域解决方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h3 id="html5-xmlhttprequest-网络请求">html5+ XMLHttpRequest 网络请求</h3> <p>上面我们花了很大篇幅讲解了<code>JavaScript XMLHttpRequest</code>对象，而且也简单的讲解了同源策略和跨域请求的常用方法，我们注意到无论是<code>JavaScript XMLHttpRequest</code>还是<code>jsonp</code>都需要通过服务器端的支持才能实现跨域，另外还有几种也有一定的局限性，所以总还是让人觉得美中不足。<code>html5+</code>提供了一个<code>XMLHttpRequest</code>模块，在<code>APP</code>端很完美的解决了这种问题，而且提供了和<code>JavaScript XMLHttpRequest</code>对象用法类似的一系列属性方法。由于本文的重在在于讲解<code>html5+ XMLHttpRequest</code>,所以前面的<code>JavaScript XMLHttpRequest</code>相关的属性方法只是初略介绍了一下，下面重点介绍<code>html5+ XMLHttpRequest</code>模块。</p> <h4 id="适用范围：">适用范围：</h4> <p>由于<code>html5+ XMLHttpRequest</code>是一种拓展方案，所以需要底层支持，基于<code>html5+ XMLHttpRequest</code>的方法不能用于非<code>5+</code>环境，如果对这些概念不清楚的欢迎先阅读我之前写的文章**<a href="http://zhaomenghuan.github.io/#!/blog/20160515" target="_blank" rel="noopener noreferrer">mui 初级入门教程（一）— 菜鸟入手 mui 的学习路线<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>**。</p> <p>我们用<code>hbuilder</code>新建一个 app 工程，然后运行下面的代码：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>initial-scale=1.0, maximum-scale=1.0, user-scalable=no<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
			document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'plusready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">plus<span class="token punctuation">.</span>net<span class="token punctuation">.</span>XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">switch</span> <span class="token punctuation">(</span> xhr<span class="token punctuation">.</span>readyState <span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
							console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;xhr请求已初始化&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
							console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;xhr请求已打开&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
							console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;xhr请求已发送&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
							console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;xhr请求已响应&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
							<span class="token keyword">if</span> <span class="token punctuation">(</span> xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
								<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token string">&quot;xhr请求成功：&quot;</span><span class="token operator">+</span>xhr<span class="token punctuation">.</span>responseText <span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
								console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;xhr请求失败：&quot;</span><span class="token operator">+</span>xhr<span class="token punctuation">.</span>readyState <span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token keyword">default</span> <span class="token operator">:</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://www.baidu.com/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>我们会发现最后弹出了弹框，里面写有百度首页的代码。</p> <h4 id="_5-xmlhttprequest-对象">5+ XMLHttpRequest 对象</h4> <p>创建一个<code>XMLHttpRequest</code> 对象，对象创建时不触发任何时间和网络请求，需和<code>open</code>，<code>send</code>方法配合使用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">plus<span class="token punctuation">.</span>net<span class="token punctuation">.</span>XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><strong>XMLHttpRequest 的属性：</strong></p></blockquote> <ul><li>**<a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.readyState" target="_blank" rel="noopener noreferrer">readyState<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>: **HTTP 请求的状态</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.response" target="_blank" rel="noopener noreferrer">response<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 请求从服务器接收到的响应数据</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.responseText" target="_blank" rel="noopener noreferrer">responseText<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 请求从服务器接收到的响应数据（字符串数据）</li> <li>**<a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.responseType" target="_blank" rel="noopener noreferrer">responseType<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>😗*请求响应数据 response 的类型</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.responseXML" target="_blank" rel="noopener noreferrer">responseXML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 请求响应的 Document 对象</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.status" target="_blank" rel="noopener noreferrer">status<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 服务器返回的 HTTP 状态代码</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.statusText" target="_blank" rel="noopener noreferrer">statusText<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 服务器返回的 HTTP 状态描述</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.timeout" target="_blank" rel="noopener noreferrer">timeout<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 请求服务器的超时时间，单位为毫秒（ms）</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.withCredentials" target="_blank" rel="noopener noreferrer">withCredentials<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 是否支持跨域请求</li></ul> <blockquote><p><strong>XMLHttpRequest 的方法：</strong></p></blockquote> <ul><li>**<a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.abort" target="_blank" rel="noopener noreferrer">abort<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>: **取消当前响应，关闭连接并且结束任何未决的网络活动</li> <li>**<a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.getAllResponseHeaders" target="_blank" rel="noopener noreferrer">getAllResponseHeaders<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>: **获取 HTTP 响应头部信息</li> <li>**<a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.getResponseHeader" target="_blank" rel="noopener noreferrer">getResponseHeader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>: **获取指定的 HTTP 响应头部的值</li> <li>**<a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.open" target="_blank" rel="noopener noreferrer">open<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>: **初始化 HTTP 请求参数，例如 URL 和 HTTP 方法，但是并不发送请求</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.send" target="_blank" rel="noopener noreferrer">send<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 发送 HTTP 请求</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.setRequestHeader" target="_blank" rel="noopener noreferrer">setRequestHeader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 指定一个 HTTP 请求的 Header</li></ul> <blockquote><p><strong>XMLHttpRequest 的事件：</strong></p></blockquote> <ul><li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.onreadystatechange" target="_blank" rel="noopener noreferrer">onreadystatechange<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 网络请求状态发生变化事件</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.onloadstart" target="_blank" rel="noopener noreferrer">onloadstart<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 网络请求开始事件</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.onprogress" target="_blank" rel="noopener noreferrer">onprogress<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 网络请求传输数据事件</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.onabort" target="_blank" rel="noopener noreferrer">onabort<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 网络请求取消事件</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.onerror" target="_blank" rel="noopener noreferrer">onerror<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 网络请求错误事件</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.onload" target="_blank" rel="noopener noreferrer">onload<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 网络请求成功事件</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.ontimeout" target="_blank" rel="noopener noreferrer">ontimeout<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 网络请求超时事件</li> <li><strong><a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.onloadend" target="_blank" rel="noopener noreferrer">onloadend<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</strong> 网络请求结束事件</li></ul> <h3 id="mui-ajax">mui ajax</h3> <p><code>mui</code>框架基于<code>htm5plus</code>的<code>XMLHttpRequest</code>，封装了常用的<code>Ajax</code>函数，支持<code>GET</code>、<code>POST</code>请求方式，支持返回<code>json</code>、<code>xml</code>、<code>html</code>、<code>text</code>、<code>script</code>数据类型； 本着极简的设计原则，<code>mui</code>提供了<code>mui.ajax</code>方法，并在<code>mui.ajax</code>方法基础上，进一步简化出最常用的<code>mui.get()</code>、<code>mui.getJSON()</code>、<code>mui.post()</code>三个方法。</p> <blockquote><p><strong>mui.ajax(url [,settings])</strong></p></blockquote> <ul><li><strong>url</strong>：请求发送的目标地址</li> <li><strong>settings</strong>：key/value 格式的 json 对象，用来配置 ajax 请求参数，支持的参数如下：
<ul><li><strong>data</strong>：发送到服务器的业务数据；</li> <li><strong>type</strong>：请求方式，目前仅支持'GET'和'POST'，默认为'GET'方式；</li> <li><strong>dataType</strong>：预期服务器返回的数据类型；如果不指定，mui 将自动根据 HTTP 包的 MIME 头信息自动判断；支持设置的 dataType 可选值： - &quot;xml&quot;: 返回 XML 文档 - &quot;html&quot;: 返回纯文本 HTML 信息； - &quot;script&quot;: 返回纯文本 JavaScript 代码 - &quot;json&quot;: 返回 JSON 数据 - &quot;text&quot;: 返回纯文本字符串</li> <li><strong>success</strong>：Type: Functon（Anything data,String textStatus,XMLHttpRequest xhr）请求成功时触发的回调函数，该函数接收三个参数： - data：服务器返回的响应数据，类型可以是 json 对象、xml 对象、字符串等； - textStatus：状态描述，默认值为'success' - xhr：xhr 实例对象</li></ul></li> <li><strong>error</strong>：Type: Functon（XMLHttpRequest xhr,String type,String errorThrown）请求失败时触发的回调函数；该函数接收三个参数： - xhr：xhr 实例对象 - type：错误描述，可取值：&quot;timeout&quot;, &quot;error&quot;, &quot;abort&quot;, &quot;parsererror&quot;、&quot;null&quot; - errorThrown：可捕获的异常对象</li> <li><strong>timeout</strong>：Type: Number，请求超时时间（毫秒），默认值为 0，表示永不超时；若超过设置的超时时间(非 0 的情况)，依然未收到服务器响应，则触发 error 回调；</li> <li><strong>headers</strong>：Type: Object,格式为：<code>{'Content-Type'：'application/json'}</code>，详情参考<a href="http://www.html5plus.org/doc/zh_cn/xhr.html#plus.net.XMLHttpRequest.setRequestHeader" target="_blank" rel="noopener noreferrer">html5+ setRequestHeader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li></ul> <p><strong>基本格式如下：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>mui<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token punctuation">{</span>
	<span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'username'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">password</span><span class="token operator">:</span><span class="token string">'password'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">dataType</span><span class="token operator">:</span><span class="token string">'json'</span><span class="token punctuation">,</span><span class="token comment">//服务器返回json格式数据</span>
	<span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'post'</span><span class="token punctuation">,</span><span class="token comment">//HTTP请求类型</span>
	<span class="token literal-property property">timeout</span><span class="token operator">:</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token comment">//超时时间设置为10秒；</span>
	<span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//服务器返回响应，根据响应结果，分析是否登录成功；</span>
		<span class="token operator">...</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">xhr<span class="token punctuation">,</span>type<span class="token punctuation">,</span>errorThrown</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//异常处理；</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><strong>mui.post( url [,data][,success] [,dataType] )</strong></p></blockquote> <p><code>mui.post()</code>方法是对<code>mui.ajax()</code>的一个简化方法，直接使用<code>POST</code>请求方式向服务器发送数据、且不处理<code>timeout</code>和异常（若需处理异常及超时，请使用<code>mui.ajax()</code>方法）</p> <div class="language-js extra-class"><pre class="language-js"><code>mui<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://server-name/login.php'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
		<span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'username'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">password</span><span class="token operator">:</span><span class="token string">'password'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//服务器返回响应，根据响应结果，分析是否登录成功；</span>
		<span class="token operator">...</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'json'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><strong>mui.get( url [,data][,success] [,dataType] )</strong></p></blockquote> <p><code>mui.get()</code>方法和<code>mui.post()</code>方法类似，只不过是直接使用<code>GET</code>请求方式向服务器发送数据、且不处理<code>timeout</code>和异常（若需处理异常及超时，请使用<code>mui.ajax()</code>方法）。如下为获得某服务器新闻列表的代码片段，服务器以 json 格式返回数据列表：</p> <div class="language-js extra-class"><pre class="language-js"><code>mui<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://server-name/list.php'</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token literal-property property">category</span><span class="token operator">:</span><span class="token string">'news'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//获得服务器响应</span>
		<span class="token operator">...</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'json'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><strong>mui.get( url [,data][,success] )</strong></p></blockquote> <p><code>mui.getJSON()</code>方法是在<code>mui.get()</code>方法基础上的更进一步简化，限定返回<code>json</code>格式的数据，其它参数和<code>mui.get()</code>方法一致，如上获得新闻列表的代码换成<code>mui.getJSON()</code>方法后，更为简洁，如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>mui<span class="token punctuation">.</span><span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token string">'http://server-name/list.php'</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token literal-property property">category</span><span class="token operator">:</span><span class="token string">'news'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//获得服务器响应</span>
		<span class="token operator">...</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>mui 在 getJSON 基础上封装了一个 jsonp 插件，具体 dem 可以参考这里：<a href="http://zhaomenghuan.github.io/demo/translation/mui-jsonp.html" target="_blank" rel="noopener noreferrer">mui-jsonp 实现有道词典翻译<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>注：初学者肯对于 GET 与 POST 的区别不是很清楚，这里不做详细介绍，若要深入了解请查看：<a href="https://segmentfault.com/a/1190000004829968" target="_blank" rel="noopener noreferrer">GET，POST — 简述<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h2 id="项目实战">项目实战</h2> <p>我们接着上一篇文章的项目开始进行本节的内容，上一篇我们讲解了<code>html5+ webview</code>的使用方法，并且实现了一个基于父子<code>webview</code>的<code>tab bar</code>切换的案例，我们这次利用网易音乐<code>API</code>接口请求数据，完成我们后续的音乐播放器功能。</p> <h3 id="api-分析">API 分析</h3> <p>网易音乐搜索 API：</p> <ul><li><strong>url</strong>：http://s.music.163.com/search/get/</li> <li><strong>type</strong>：&quot;GET&quot;或“POST&quot; //HTTP 请求类型</li> <li>请求参数：
<ul><li><strong>type</strong>: 1</li> <li><strong>s</strong>: //关键词</li> <li><strong>limit</strong>: 10 //限制返回结果数为 10</li> <li><strong>offset</strong>: 0 //偏移</li> <li><strong>src</strong>: lofter //可为空</li> <li><strong>filterDj</strong>: true | false //可为空</li> <li><strong>callback</strong>: //为空时返回 json，反之返回 jsonp callback</li></ul></li></ul> <p>由于 HTTP 请求类型包含 get，我们只需要把请求的参数拼接到 url 里面就可以得到返回的数据，格式为 url?key1=value1&amp;key2=value2。</p> <p>在这个例子中我们打开这个网址<a href="http://s.music.163.com/search/get/?type=1&limit=5&s=%E5%96%9C%E6%AC%A2%E4%BD%A0" target="_blank" rel="noopener noreferrer">http://s.music.163.com/search/get/?type=1&amp;limit=5&amp;s=喜欢你<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,我们会发现一些数据返回了，如下图：</p> <p><img src="http://oo1uw74rb.bkt.clouddn.com/20160529001.png" alt></p> <p>OK，我们下面讲解怎么通过程序得到这些数据，并且我们并且怎么解析这些数据。</p> <p>在开始之前我们先对我们要得到的数据进行美化，这里我在网上随便搜了一个
<a href="http://www.bejson.com" target="_blank" rel="noopener noreferrer">在线 JSON 校验格式化工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，我们只需要把刚刚那些数据复制粘贴到我给的这个工具里面，然后点击校验就变整齐了。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;songCount&quot;</span><span class="token operator">:</span> <span class="token number">3224</span><span class="token punctuation">,</span>
    <span class="token property">&quot;songs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">28949444</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;喜欢你&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;artists&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">7763</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;G.E.M.邓紫棋&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;picUrl&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;album&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2956076</span><span class="token punctuation">,</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;喜欢你&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;artist&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;picUrl&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;picUrl&quot;</span><span class="token operator">:</span>
            <span class="token string">&quot;http://p1.music.126.net/u_1EudmF8Swgow6vfgYe1g==/8896148580676276.jpg&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;audio&quot;</span><span class="token operator">:</span>
          <span class="token string">&quot;http://m2.music.126.net/_icR1apQHVl8wa0EP_REkQ==/3269947581061892.mp3&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;djProgramId&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">200</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们可以看到</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;picUrl&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://p1.music.126.net/u_1EudmF8Swgow6vfgYe1g==/8896148580676276.jpg&quot;</span>
</code></pre></div><p>打开这个图片地址我们就可以看到邓紫棋了，哈哈，也就是说我们只需要抓取到这个地址就可以进行下面的工作咯，其他的类似。</p> <h3 id="mui-ajax-请求实例">mui.ajax 请求实例</h3> <p>我们在上次新建的 M-BOX 下的 home.html 下写这个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;../js/mui.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
  	<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;http://s.music.163.com/search/get/&quot;</span><span class="token punctuation">;</span>
	mui<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token punctuation">{</span>
		<span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	       <span class="token string-property property">'type'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	        <span class="token string-property property">'s'</span><span class="token operator">:</span> <span class="token string">&quot;喜欢你&quot;</span><span class="token punctuation">,</span>
	        <span class="token string-property property">'limit'</span><span class="token operator">:</span> <span class="token number">10</span>
	    <span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token literal-property property">dataType</span><span class="token operator">:</span><span class="token string">'json'</span><span class="token punctuation">,</span><span class="token comment">//服务器返回json格式数据</span>
		<span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'post'</span><span class="token punctuation">,</span><span class="token comment">//HTTP请求类型</span>
		<span class="token literal-property property">timeout</span><span class="token operator">:</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token comment">//超时时间设置为10秒；</span>
		<span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">xhr<span class="token punctuation">,</span>type<span class="token punctuation">,</span>errorThrown</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//异常处理；</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p><code>hbuilder</code>很方便的一个功能就是真机调试，我们直接将电脑与手机连接，通过<code>console.log()</code> 函数可以很方便的将数据在控制台打印出来，例如上述例子如果我们在<code>success</code>的回调函数中执行<code>console.log(data);</code>,在控制台会输出<code>[object Object]</code>，我们只需要利用<code>JSON.stringify()</code> 方法可以将任意的<code>JavaScript</code> 值序列化成 <code>JSON</code> 字符串。</p> <h3 id="javascript-json-语法基础">Javascript JSON 语法基础</h3> <p>每次看到很多同学在解析<code>json</code>的时候错误百出，严重暴漏了基本功，这里我就总结几条与解析<code>json</code>可能相关的知识点。</p> <h4 id="什么是-json？">什么是 JSON？</h4> <p><strong>JSON</strong>:<code>JavaScript Object Notation</code>(JavaScript 对象表示法)，<code>JSON</code> 是存储和交换文本信息的语法,独立于语言。类似 <code>XML</code>。<code>JSON</code> 比 <code>XML</code> 更小、更快，更易解析,具有自我描述性，更易理解的特点。</p> <p><code>JSON</code>就是一串字符串，只不过元素会使用特定的符号标注。</p> <ul><li>{} 双括号表示对象</li> <li>[] 中括号表示数组</li> <li>&quot;&quot; 双引号内是属性或值</li> <li>：表示后者是前者的值(这个值可以是字符串、数字、也可以是另一个数组或对象)</li></ul> <p><code>{&quot;name&quot;: &quot;Dcloud&quot;}</code>可以理解为是一个包含<code>name</code>为<code>Dcloud</code>的对象;
<code>[{&quot;name&quot;: &quot;mui&quot;},{&quot;name&quot;: &quot;html5+&quot;}]</code>就表示包含两个对象的数组。</p> <p>通过<code>JavaScript</code>，您可以创建一个对象数组，并像这样进行赋值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> employees <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">&quot;Doe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">&quot;Anna&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">&quot;Smith&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">&quot;Peter&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">&quot;Jones&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>可以像这样访问 JavaScript 对象数组中的第一项：
<code>employees[0].lastName;</code>
返回的内容是：
<code>Doe</code>
可以像这样修改数据：
<code>employees[0].firstName = &quot;Jonatan&quot;;</code></p> <h4 id="json-stringify-和-json-parse">JSON.stringify 和 JSON.parse</h4> <p>这里需要特别说明的是两个非常有用的方法：JSON.stringify 和 JSON.parse。我们可以通过 JSON.stringify 将 json 对象转成 json 字符串，方便用 alert,console.log 打印出来，可以方便的查看 json 对象内容。反之我们可以通过 JSON.parse 将 json 字符串转成 json 对象以便可以方便对 json 对象取值。例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 场景1</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;zhaomenghuan&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">22</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;object&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;{&quot;name&quot;:&quot;zhaomenghuan&quot;,&quot;age&quot;:22}&quot;</span>

<span class="token comment">// 场景2</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'{&quot;name&quot;:&quot;zhaomenghuan&quot;,&quot;age&quot;:22}'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;string&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;zhaomenghuan&quot;</span>
</code></pre></div><p>上面的例子列举了两种应用场景，大家根据自己的情况合适的选取正确的方法。</p> <h4 id="运算符-和">运算符[ ] 和 .</h4> <p>**[ ]**可以用于数组和对象取值，数组中按下边取值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;four&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>对象属性取值时，当我们不知道属性名或属性名本身包含点（<strong>.</strong>）的键，应当使用**[ ]**。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>var obj={
  id:&quot;obj&quot;,
  &quot;self.ref&quot;:ref
}
console.log(obj[&quot;self.ref&quot;]);
</code></pre></div><p>**.**运算符的左边为一个对象，右边为属性名。如：obj.id</p> <h4 id="可以动态访问属性：">可以动态访问属性：</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token string">&quot;property&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">&quot;hello word&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="数组的-map-方法：">数组的 map 方法：</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> item <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>数组<code>map</code>方法可以接受一个匿名函数，数组中每个元素都会调用这个匿名函数，并且讲返回结果放在一个数组中。</p> <h3 id="获取数据更新-ui">获取数据更新 UI</h3> <p><code>mui</code>中的<code>each()</code>方法既是一个类方法，同时也是一个对象方法，两个方法适用场景不同；换言之，你可以使用<code>mui.each()</code>去遍历数组或<code>json</code>对象，也可以使用<code>mui(selector).each()</code>去遍历<code>DOM</code>结构。</p> <blockquote><p><strong>mui.each( obj , handler )</strong></p></blockquote> <ul><li><strong>obj</strong> :
<code>Type: Array||JSONObj</code>
需遍历的对象或数组；若为对象，仅遍历对象根节点下的 key</li> <li><strong>handler</strong> :
<code>Type: Function( Integer||String index,Anything element)</code>
为每个元素执行的回调函数；其中，index 表示当前元素的下标或 key，element 表示当前匹配元素</li></ul> <p>对于前面说到的音乐<code>api</code>返回的<code>json</code>数据，首先我们要通过<code>var songs=data.result.songs;</code>获取<code>&quot;songs&quot;</code>的值，然后遍历<code>&quot;songs&quot;</code>对象的子对象。</p> <div class="language-js extra-class"><pre class="language-js"><code>···
<span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// console.log(JSON.stringify(data));</span>
	<span class="token keyword">var</span> songs<span class="token operator">=</span>data<span class="token punctuation">.</span>result<span class="token punctuation">.</span>songs<span class="token punctuation">;</span>
	mui<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>songs<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	    <span class="token keyword">var</span> id <span class="token operator">=</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
	        name <span class="token operator">=</span> item<span class="token punctuation">.</span>album<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
	        author <span class="token operator">=</span> item<span class="token punctuation">.</span>artists<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
	    	picUrl <span class="token operator">=</span> item<span class="token punctuation">.</span>album<span class="token punctuation">.</span>picUrl<span class="token punctuation">,</span>
	    	audio <span class="token operator">=</span> item<span class="token punctuation">.</span>audio<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
···
</code></pre></div><p>我们用上述代码可以得到我们想要的数据，下面就是需要将信息展示出来，这里我们只获取 歌曲<code>id</code>、歌曲所属专辑名<code>name</code>、歌曲第一作者<code>author</code>、歌曲所属专辑图片<code>picUrl</code> 、歌曲音频文件<code>audio</code>。</p> <p>考虑到要加载很多图片，这里我们使用懒加载实现效果，这里我们直接使用<code>hello mui</code>里面的模板页面<code>lazyload-image.html</code>，我们需要引入<code>mui.lazyload.js</code>和<code>mui.lazyload.img.js</code>两个文件，还有占位图。下面先贴出修改后的基本的代码，然后再讲解其中的内容。
<strong>home.html:</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>M-BOX<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>apple-mobile-web-app-capable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>apple-mobile-web-app-status-bar-style<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>black<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--标准mui.css--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../css/mui.min.css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
			<span class="token selector">.mui-content&gt;.mui-table-view:first-child</span> <span class="token punctuation">{</span>
				<span class="token property">margin-top</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mui-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mui-table-view mui-table-view-chevron<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../js/mui.min.js <span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../js/mui.lazyload.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../js/mui.lazyload.img.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
		mui<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;http://s.music.163.com/search/get/&quot;</span><span class="token punctuation">;</span>
        mui<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token punctuation">{</span>
			<span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">'type'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token string-property property">'s'</span><span class="token operator">:</span> <span class="token string">&quot;喜欢你&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">'limit'</span><span class="token operator">:</span> <span class="token number">10</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token literal-property property">dataType</span><span class="token operator">:</span><span class="token string">'json'</span><span class="token punctuation">,</span><span class="token comment">//服务器返回json格式数据</span>
			<span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'post'</span><span class="token punctuation">,</span><span class="token comment">//HTTP请求类型</span>
			<span class="token literal-property property">timeout</span><span class="token operator">:</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token comment">//超时时间设置为10秒；</span>
			<span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//console.log(JSON.stringify(data));</span>
				<span class="token keyword">var</span> songs<span class="token operator">=</span>data<span class="token punctuation">.</span>result<span class="token punctuation">.</span>songs<span class="token punctuation">;</span>

				<span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">var</span> fragment <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">var</span> li<span class="token punctuation">;</span>
				mui<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>songs<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				     <span class="token keyword">var</span> id <span class="token operator">=</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
				        name <span class="token operator">=</span> item<span class="token punctuation">.</span>album<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				        author <span class="token operator">=</span> item<span class="token punctuation">.</span>artists<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				    	picUrl <span class="token operator">=</span> item<span class="token punctuation">.</span>album<span class="token punctuation">.</span>picUrl<span class="token punctuation">,</span>
				    	audio <span class="token operator">=</span> item<span class="token punctuation">.</span>audio<span class="token punctuation">;</span>

				    li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					li<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'mui-table-view-cell mui-media'</span><span class="token punctuation">;</span>
					li<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'&lt;a class=&quot;mui-navigate-right&quot; id='</span><span class="token operator">+</span> id <span class="token operator">+</span><span class="token string">' data-audio='</span><span class="token operator">+</span> audio <span class="token operator">+</span><span class="token string">'&gt;'</span><span class="token operator">+</span>
					    				<span class="token string">'&lt;img class=&quot;mui-media-object mui-pull-left&quot; data-lazyload=&quot;'</span><span class="token operator">+</span>picUrl<span class="token operator">+</span><span class="token string">'&quot;&gt;'</span><span class="token operator">+</span>
					    				<span class="token string">'&lt;div class=&quot;mui-media-body&quot;&gt;'</span><span class="token operator">+</span>name<span class="token operator">+</span>
					    					<span class="token string">'&lt;p class=&quot;mui-ellipsis&quot;&gt;'</span><span class="token operator">+</span>author<span class="token operator">+</span><span class="token string">'&lt;/p&gt;'</span><span class="token operator">+</span>
					    				<span class="token string">'&lt;/div&gt;'</span><span class="token operator">+</span>
					    			<span class="token string">'&lt;/a&gt;'</span><span class="token punctuation">;</span>
					fragment<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>

				list<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fragment<span class="token punctuation">)</span>

				<span class="token function">mui</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">imageLazyload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
					<span class="token literal-property property">placeholder</span><span class="token operator">:</span> <span class="token string">'../img/60x60.gif'</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">xhr<span class="token punctuation">,</span>type<span class="token punctuation">,</span>errorThrown</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//异常处理；</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//列表点击事件</span>
		<span class="token function">mui</span><span class="token punctuation">(</span><span class="token string">&quot;#list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'tap'</span><span class="token punctuation">,</span><span class="token string">'li a'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">var</span> audio <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-audio'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//打开详情页面</span>
			mui<span class="token punctuation">.</span><span class="token function">openWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				<span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'music.html'</span><span class="token punctuation">,</span>
			    <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'music.html'</span><span class="token punctuation">,</span>
			    <span class="token literal-property property">extras</span><span class="token operator">:</span><span class="token punctuation">{</span>
			        <span class="token literal-property property">musicId</span><span class="token operator">:</span>id<span class="token punctuation">,</span>
			        <span class="token literal-property property">audioUrl</span><span class="token operator">:</span>audio
			    <span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>music.html:</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../css/mui.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../js/mui.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
		mui<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mui<span class="token punctuation">.</span><span class="token function">plusReady</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">var</span> self <span class="token operator">=</span> plus<span class="token punctuation">.</span>webview<span class="token punctuation">.</span><span class="token function">currentWebview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">var</span> musicId <span class="token operator">=</span> self<span class="token punctuation">.</span>musicId<span class="token punctuation">;</span>
			<span class="token keyword">var</span> audioUrl <span class="token operator">=</span> self<span class="token punctuation">.</span>audioUrl<span class="token punctuation">;</span>
			document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;musicId:&quot;</span> <span class="token operator">+</span> musicId <span class="token operator">+</span> <span class="token string">&quot;&lt;br /&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;audioUrl:&quot;</span> <span class="token operator">+</span> audioUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>我们这里说几个开发者常见的问题：</p> <h4 id="拼接-html-字符串">拼接 html 字符串</h4> <p>首先打开<code>hello mui</code>里面的模板页面<code>lazyload-image.html</code>，我们打开控制台查看<code>elements</code>，结构如下：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mui-table-view mui-table-view-chevron<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mui-table-view-cell mui-media<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mui-navigate-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mui-media-object mui-pull-left<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-lazyload-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.dcloud.io/hellomui/images/1.jpg?version=447.4190210457891<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mui-media-body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
				主标题
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mui-ellipsis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>列表二级标题<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>我们需要将获取的内容动态的填充到这个里面，这里常用的方法就是动态的生成节点，这里我们就要用到<code>DOM</code>的创建方法<code>document.createElement</code>,通过这个方法我们可以生成一个节点:
<code>li = document.createElement('li');</code>这个可以生成一个<code>li</code>节点，我们需要为这个<code>li</code>指定<code>class</code>,通过对对象的<code>className</code>赋值实现，如：<code>li.className = 'mui-table-view-cell mui-media';</code>,我们使用<code>appendChild(li)</code>方法将<code>li</code>节点挂着父节点上，比如:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这个就是把<code>li</code>节点挂在<code>list</code>下，同理我们可以在<code>li</code>节点下 创建子节点，上面为了简单，我们使用给<code>innerHTML</code>属性赋值的做法，这样<code>innerHTML</code>的值同样会挂在<code>li</code>节点下，大家需要注意的是<code>innerHTML</code>属性的值我字符串，所以我们往中间插入了变量，要使用<code>+</code>连接起来。我们可以通过循环创建多个节点，如下面这样创建十个段落：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> p <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> oTxt <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">&quot;段落&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  p<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>oTxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面我们使用的是<code>mui.each()</code>方法，效果类似。</p> <p>如果细心的同学或许注意到我们使用了一个奇怪的写法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> fragment <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mui<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>songs<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token operator">...</span>
	fragment<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fragment<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>为啥我们要在这里使用<code>document.createDocumentFragment()</code>呢？</p> <p>如果是对前端技术感兴趣的同学说不定回去查一下，我相信大部分人可能就放过了吧！这里我查了一下资料：</p> <blockquote><p>在《javascript 高级程序设计》一书的 6.3.5:创建和操作节点一节中，介绍了几种动态创建 html 节点的方法，其中有以下几种常见方法：</p></blockquote> <ul><li>crateAttribute(name)：　　　　　 　　用指定名称 name 创建特性节点</li> <li>createComment(text)：　　　　　　　创建带文本 text 的注释节点</li> <li>createDocumentFragment()：　　　　 创建文档碎片节点</li> <li>createElement(tagname)：　　　　　 创建标签名为 tagname 的节点</li> <li>createTextNode(text)：　　　　　　 创建包含文本 text 的文本节点</li></ul> <p>其中最感兴趣且以前没有接触过的一个方法是 createDocumentFragment()方法，书中介绍说：在更新少量节点的时候可以直接向 document.body 节点中添加，但是当要向 document 中添加大量数据是，如果直接添加这些新节点，这个过程非常缓慢，因为每添加一个节点都会调用父节点的 appendChild()方法，为了解决这个问题，可以创建一个文档碎片，把所有的新节点附加其上，然后把文档碎片一次性添加到 document 中。—— <a href="http://www.cnblogs.com/yunfour/archive/2011/06/21/2085911.html" target="_blank" rel="noopener noreferrer">document 的 createDocumentFragment()方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="页面传值">页面传值</h4> <p>我们点击了列表，我们会进入一个详情页，我们肯定是想知道我们究竟点了哪一个我们想把一些数据传入到详情页面，这里我们使用了<code>mui.openWindow()</code>方法中的拓展参数<code>extras</code>传入几个值，在详情页面通过<code>plus.webview.currentWebview</code>获取：</p> <div class="language-js extra-class"><pre class="language-js"><code>mui<span class="token punctuation">.</span><span class="token function">plusReady</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> self <span class="token operator">=</span> plus<span class="token punctuation">.</span>webview<span class="token punctuation">.</span><span class="token function">currentWebview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> musicId <span class="token operator">=</span> self<span class="token punctuation">.</span>musicId<span class="token punctuation">;</span>
  <span class="token keyword">var</span> audioUrl <span class="token operator">=</span> self<span class="token punctuation">.</span>audioUrl<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;musicId:&quot;</span> <span class="token operator">+</span> musicId <span class="token operator">+</span> <span class="token string">&quot;&lt;br /&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;audioUrl:&quot;</span> <span class="token operator">+</span> audioUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这是在页面初始化时，通过扩展参数<code>extras</code>传值；另外还有页面已创建，通过自定义事件传值，参考 mui 官网中<a href="http://dev.dcloud.net.cn/mui/event/#customevent" target="_blank" rel="noopener noreferrer">自定义事件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的介绍，这里先不讲得太多，后面会专门花时间详细讲解相关细节。</p> <h4 id="jsonp-实现">jsonp 实现</h4> <p>由于前面已经详细讲解，这里就不再赘述，只给出一个基本的 demo：<a href="http://zhaomenghuan.github.io/utils/music.html" target="_blank" rel="noopener noreferrer">jsonp 获取网易云音乐<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>当我们写到这里，发现这篇依然是长长的一篇干货，很多内容摘自文档，主要是为了新手可以详细去了解整个流程。其实还有很多没有写出来，限于篇幅还是后面再写吧！由于代码在文章中写得很详细，工程代码先不给出来，最后整个系列写完了再放出来吧！</p> <h2 id="随便聊聊">随便聊聊</h2> <p>这段时间在技术上花得时间确实太多，刚刚和女朋友在图书馆学习，她和我开个玩笑，我在忙着做作业因为不喜欢被打扰，然后就觉得很烦躁，然后就聊着聊着她说和我分手，我不知道她是不是认真的，只是觉得空空的，自从走上代码这条路，我已经失去太多东西，我不想失去女朋友，毕竟谈了三年，我是真的爱她，写完这个就去找她道歉吧！还有要向环头道歉，昨天可能说话有点直接，不小心伤到他了，后来想想真的可能是我太较真，他只是想玩玩程序，我何必那种执着呢？如果环头看到这篇博客，希望你可以原谅哥，我只是不想让你走弯路，或许每个都应该自己去把握自己的人生，我们不必去干涉。</p> <div data-v-3bd334e8><p class="descript" data-v-3bd334e8>写这些代码也许就一两个小时的事，写一篇大家好接受的文章需要几天的酝酿，如果文章对您有帮助请我喝杯咖啡吧！</p> <img src="/supportme.png" class="pay-code" data-v-3bd334e8> <div data-v-3bd334e8><div id="container"></div></div> <div class="footer" data-v-4f0df4b0 data-v-3bd334e8><p data-v-4f0df4b0>站点总访问量： 站点总访客数：</p> <p data-v-4f0df4b0>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" data-v-4f0df4b0>知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></p> <p data-v-4f0df4b0>赵梦欢 © 2015 - 2023</p></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.f3e141ba.js" defer></script><script src="/assets/js/45.2206665b.js" defer></script><script src="/assets/js/18.c373a36e.js" defer></script><script src="/assets/js/34.124c31c0.js" defer></script>
  </body>
</html>
