(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{295:function(t,n,s){"use strict";s.r(n);var e=s(1),a=Object(e.a)({},(function(){var t=this,n=t._self._c;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"android-文件阅读器调研"}},[t._v("Android 文件阅读器调研")]),t._v(" "),n("h2",{attrs:{id:"前言"}},[t._v("前言")]),t._v(" "),n("p",[t._v("移动端无纸化作为一种趋势，文件阅读器是一种基本需求，iOS 系统天然的对 Office 组件的支持，直接可以在应用内打开，Android 里面就比较头疼了，对于 PDF、Word、Excel、PPT、TXT 等多种格式的文件要支持预览，本身就没有一个特别好的统一的方式，本文是笔者搜索一些资料做的一个汇总。")]),t._v(" "),n("h2",{attrs:{id:"集成现成的产品"}},[t._v("集成现成的产品")]),t._v(" "),n("h3",{attrs:{id:"使用-googledocs、office-online-等在线预览"}},[t._v("使用 GoogleDocs、office online 等在线预览")]),t._v(" "),n("p",[t._v("在线平台获取文档的 URL，通过 Office 平台提供的链接地址指向需要预览的文档地址即可，例如：")]),t._v(" "),t._m(0),t._v(" "),t._m(1),n("p",[t._v("这种方案存在的问题是国内通常情况下访问不了 Google 提供 的服务，因此这种方案可以不考虑。")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._m(4),t._v(" "),n("p",[t._v("Office 平台在线预览限制：")]),t._v(" "),t._m(5),t._v(" "),n("h3",{attrs:{id:"调起第三方支持-office-阅读的应用"}},[t._v("调起第三方支持 Office 阅读的应用")]),t._v(" "),n("p",[t._v("可行方案中最简单的一种方式，缺点是会跳出自己的应用转到第三方应用中，而且需要具备以下两个条件：")]),t._v(" "),t._m(6),t._v(" "),n("p",[t._v("实现这个方案的代码示例如下：")]),t._v(" "),t._m(7),n("h3",{attrs:{id:"集成第三方-sdk-通过-android-原生实现"}},[t._v("集成第三方 SDK 通过 Android 原生实现")]),t._v(" "),n("p",[t._v("TBS 腾讯浏览服务是一个不错的三方 SDK 集成选择：")]),t._v(" "),t._m(8),t._v(" "),n("p",[t._v("其他的 SDK 类似不做列举，基本上都是 SDK 集成的问题了。")]),t._v(" "),n("h3",{attrs:{id:"企业级云端在线-office-私有化部署"}},[t._v("企业级云端在线 Office 私有化部署")]),t._v(" "),n("p",[t._v("毕升 Office 推出基础版和集成版两个私有化部署基本版本；目前面向所有用户免费。基础版是指包含：毕升 Office 的企业云盘（文件云端管理，组织结构权限，文件/团队共享等）+ 毕升云端 Office。满足企业 Office 文件云端协作以及云端编辑，预览的需求。基础板部署脚本托管在 github 和国内的 gitee。")]),t._v(" "),n("ul",[n("li",[t._v("官网："),n("a",{attrs:{href:"https://bishengoffice.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://bishengoffice.com/"),n("OutboundLink")],1)]),t._v(" "),n("li",[t._v("github 部署代码："),n("a",{attrs:{href:"https://github.com/ibisheng/onlyoffice-deploy",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/ibisheng/onlyoffice-deploy"),n("OutboundLink")],1)])]),t._v(" "),n("h2",{attrs:{id:"基于开源方案改造"}},[t._v("基于开源方案改造")]),t._v(" "),n("h3",{attrs:{id:"pdf-的解决方案"}},[t._v("PDF 的解决方案")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://mozilla.github.io/pdf.js/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PDF.js"),n("OutboundLink")],1),t._v("，提供了一套较完善的在 H5 页面中阅读 PDF 的方案，同时支持 Web 前端，Android 和 iOS WebView 加载。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://android.googlesource.com/platform/external/pdfium/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PDFium"),n("OutboundLink")],1),t._v("：Google 和 Foxit 合作开源的 Foxit 的 PDF 源码，作为 Chrome 浏览器的 PDF 渲染引擎组件，当然这是 C/C++ 实现的。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/barteksc/PdfiumAndroid",target:"_blank",rel:"noopener noreferrer"}},[t._v("PdfiumAndroid"),n("OutboundLink")],1),t._v("：mshockwave 基于 PDFium 基础上适配 Android 平台的函数库，barteksc 在这个基础上再做了一些修改。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/barteksc/AndroidPdfViewer",target:"_blank",rel:"noopener noreferrer"}},[t._v("AndroidPdfViewer"),n("OutboundLink")],1),t._v("：barteksc 基于 PdfiumAndroid 基础上实现的一个 PDF 阅读 Demo，支持常见的手势，缩放，双击等效果。")])]),t._v(" "),n("h3",{attrs:{id:"word-的解决方案"}},[t._v("Word 的解决方案")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://poi.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("poi"),n("OutboundLink")],1),t._v(": POI 为 Java 系处理 office 文档的比较优秀的开源库，移植到 Android 相对比较复杂，问题也比较多。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/centic9/poi-on-android",target:"_blank",rel:"noopener noreferrer"}},[t._v("poi-on-android"),n("OutboundLink")],1),t._v("：基于 POI 移植到 Android 的版本，相对 POI 做了一些改进，但是基本是也是比较空缺的。")]),t._v(" "),n("li",[n("a",{attrs:{href:"http://elim.iteye.com/blog/2049110",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 POI 读写 word docx 文件"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://www.w3cschool.cn/apache_poi_word/apache_poi_word_overview.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache POI Word"),n("OutboundLink")],1)])]),t._v(" "),n("h3",{attrs:{id:"excel-的解决方案"}},[t._v("Excel 的解决方案")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/paulhodel/jexcel",target:"_blank",rel:"noopener noreferrer"}},[t._v("jexcel"),n("OutboundLink")],1)])]),t._v(" "),n("site-footer")],1)}),[function(){var t=this._self._c;return t("p",[t("strong",[this._v("GoogleDocs：")])])},function(){var t=this._self._c;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("https://docs.google.com/viewer?url=http://video.ch9.ms/build/2011/slides/TOOL-532T_Sutter.pptx\n")])])])},function(){var t=this._self._c;return t("p",[t("strong",[this._v("office online：")])])},function(){var t=this._self._c;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("https://view.officeapps.live.com/op/view.aspx?src=http://video.ch9.ms/build/2011/slides/TOOL-532T_Sutter.pptx\n")])])])},function(){var t=this._self._c;return t("p",[this._v("平台地址："),t("code",[this._v("http://view.officeapps.live.com/op/view.aspx?src=")]),this._v(" 和文档地址通过拼接的地址即可实现 office 的在线预览。")])},function(){var t=this._self._c;return t("ul",[t("li",[this._v("Word 和 PowerPoint 文档必须小于 10 M，Excel 必须小于 5M;")]),this._v(" "),t("li",[this._v("文档支持的格式：\n"),t("ul",[t("li",[this._v("Word: docx dotx")]),this._v(" "),t("li",[this._v("Excel：xlsx、xlsb、xls、xlsm")]),this._v(" "),t("li",[this._v("PowerPoint: pptx、 ppsx、 ppt、 pps、 potx、 ppsm")])])])])},function(){var t=this._self._c;return t("ul",[t("li",[this._v("PDF 文件需要下载到本地，不支持在线阅读")]),this._v(" "),t("li",[this._v("用户手机中安装了支持 PDF 阅读的应用")])])},function(){var t=this,n=t._self._c;return n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("openWord")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("File")]),t._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" intent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"android.intent.action.VIEW"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  intent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addCategory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"android.intent.category.DEFAULT"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  intent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addFlags")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FLAG_ACTIVITY_NEW_TASK")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Uri")]),t._v(" uri "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Uri")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fromFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  intent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setDataAndType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uri"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/msword"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createChooser")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Open File"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this._self._c;return t("p",[t("img",{attrs:{src:"https://x5.tencent.com/tbs/img/article/file1.png",alt:""}})])}],!1,null,null,null);n.default=a.exports}}]);